<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ustaya Sor</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Inter font is used for a modern look */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d1117; /* GitHub Dark Background */
            color: #c9d1d9; /* Light gray text */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
        }
        .container {
            max-width: 900px;
            width: 100%;
            background-color: #161b22; /* Slightly lighter container background */
            padding: 2.5rem;
            border-radius: 1rem;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4);
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
            border: 1px solid #30363d; /* Subtle border */
        }
        
        h1 {
            font-size: 1.75rem;
            font-weight: 700;
            color: #58a6ff; /* Blue accent color */
            margin: 0;
            padding: 0;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        .subtitle {
            font-size: 1rem;
            color: #8b949e;
            margin-top: 0.5rem;
        }
        
        textarea {
            width: 100%;
            padding: 1rem;
            border-radius: 0.75rem;
            background-color: #0d1117; /* Darker input area */
            border: 1px solid #30363d;
            color: #c9d1d9;
            resize: none;
            transition: border-color 0.3s, box-shadow 0.3s;
            line-height: 1.6;
            outline: none;
        }
        textarea:focus {
            border-color: #58a6ff;
            box-shadow: 0 0 0 3px rgba(88, 166, 255, 0.2);
        }
        
        /* Butonlar için ortak stil */
        .btn-base {
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            border: none;
            transition: background-color 0.2s, transform 0.1s, box-shadow 0.2s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            width: 100%; /* Full width on mobile */
        }

        #askButton {
            @apply btn-base text-white;
            background-color: #238636; /* GitHub Green Button */
        }

        #askButton:hover {
            background-color: #2ea043;
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.4);
        }
        #askButton:active {
            transform: scale(0.98);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        #askButton:disabled {
            background-color: #238636;
            opacity: 0.5;
            cursor: not-allowed;
            box-shadow: none;
        }

        #aboutButton {
            @apply btn-base text-white; /* mt-4 sm:mt-0 kaldırıldı, boşluk flex gap ile sağlanıyor */
            background-color: #30363d; /* Gray Button for secondary action */
        }

        #aboutButton:hover {
            background-color: #484f58;
        }
        #aboutButton:active {
            transform: scale(0.98);
        }

        #answerBox {
            min-height: 180px;
            overflow-y: auto;
            padding: 1.5rem;
            border-radius: 0.75rem;
            background-color: #0d1117;
            border: 1px solid #30363d;
            line-height: 1.7;
            white-space: pre-wrap;
            word-wrap: break-word;
            position: relative;
        }

        /* Loading Spinner Styles */
        .loading-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: rgba(13, 17, 23, 0.9); /* Semi-transparent dark overlay */
            transform: translateY(-100%);
            opacity: 0;
            transition: transform 0.5s ease-in-out, opacity 0.5s ease-in-out;
            border-radius: 0.75rem;
            z-index: 10;
        }
        
        .loading-container.active {
            transform: translateY(0);
            opacity: 1;
        }
        
        .spinner {
            border: 4px solid rgba(201, 209, 217, 0.2);
            border-top: 4px solid #58a6ff; /* Blue spinner */
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 100;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
        }

        .modal-overlay.open {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background-color: #161b22;
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.6);
            max-width: 90%;
            width: 500px;
            transform: scale(0.9);
            transition: transform 0.3s;
            border: 1px solid #30363d;
        }

        .modal-overlay.open .modal-content {
            transform: scale(1);
        }

        .modal-close-btn {
            background: none;
            border: none;
            color: #c9d1d9;
            font-size: 1.5rem;
            cursor: pointer;
            position: absolute;
            top: 1rem;
            right: 1rem;
        }

        /* Responsive Layout - Mobil (varsayılan: dikey) ve Masaüstü (sm: yatay) geçişi */
        .input-group {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        
        @media (min-width: 640px) {
            .input-group {
                flex-direction: row;
                align-items: flex-end;
            }
            .input-group textarea {
                flex-grow: 1;
            }
            /* Buton grubu için özel kural kaldırıldı, HTML'deki flex-col yeterli */
        }
    </style>
</head>
<body>

    <div class="container">
        <div class="title-container text-center mb-6">
            <h1>Ustaya Sor - AI Asistanı</h1>
            <p class="subtitle">Aklındaki soruları bana sor, sana en iyi şekilde yol göstereyim.</p>
        </div>
        
        <div class="input-group">
            <textarea
                id="questionInput"
                rows="4"
                placeholder="Örneğin: 'En iyi kahve demleme yöntemi nedir?' veya 'Hava durumu nasıl?'"
            ></textarea>
            
            <!-- Butonlar için yeni mobil uyumlu dikey hizalama -->
            <div class="flex flex-col gap-3 w-full sm:w-auto">
                <button id="askButton">Ustaya Sor</button>
                <button id="aboutButton">Hakkında</button>
            </div>
        </div>

        <!-- Cevap Kutusu -->
        <div id="answerBox" class="mt-4">
            Buraya yazdığın soruların cevapları, Usta tarafından detaylıca hazırlanıp sana sunulacak.
        </div>
        
        <!-- Bize Ulaşın Bölümü (Sayfanın En Altı) -->
        <div class="mt-8 pt-4 border-t border-gray-700 text-center text-sm text-gray-500">
            <p class="mb-2 text-white font-semibold">Bize Ulaşın</p>
            
            <!-- Sosyal Medya Bağlantıları -->
            <div class="flex justify-center space-x-6">
                <!-- Instagram Bağlantısı -->
                <a 
                    href="https://www.instagram.com/beytu.demirkoll?utm_source=qr&igsh=MTI3dXh1bGs0dw==" 
                    target="_blank" 
                    rel="noopener noreferrer"
                    class="inline-flex items-center text-pink-400 hover:text-pink-300 transition duration-150 ease-in-out font-medium group"
                >
                    <!-- Instagram İkonu (Inline SVG) -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2 group-hover:scale-110 transition duration-150"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line></svg>
                    Instagram
                </a>

                <!-- Facebook Bağlantısı (Yeni Eklendi) -->
                <a 
                    href="https://www.facebook.com/profile.php?id=61563881683023" 
                    target="_blank" 
                    rel="noopener noreferrer"
                    class="inline-flex items-center text-blue-500 hover:text-blue-400 transition duration-150 ease-in-out font-medium group"
                >
                    <!-- Facebook İkonu (Inline SVG) -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="mr-2 group-hover:scale-110 transition duration-150"><path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path></svg>
                    Facebook
                </a>
            </div>
            
            <p class="mt-4 text-xs text-gray-600">© 2025 Ustaya Sor. Tüm hakları saklıdır.</p>
        </div>
    </div>

    <!-- Hakkında Penceresi (Modal) -->
    <div id="aboutModal" class="modal-overlay">
        <div class="modal-content relative">
            <button class="modal-close-btn" onclick="closeModal()">
                <!-- X Kapatma İkonu (Inline SVG) -->
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
            <h2 class="text-xl font-bold mb-4 text-white">Ustaya Sor Uygulaması Hakkında</h2>
            <p class="mb-3 text-gray-400">
                Bu uygulama, yapay zeka destekli bir asistan hizmetidir.
            </p>
            <p class="mb-3 text-gray-400">
                Amacı, sorduğunuz her türlü soruya (bilgi, tarif, öneri, kod yardımı vb.) hızlı ve samimi bir dille, "Usta" kişiliği altında cevap vermektir.
            </p>
            <p class="text-sm text-gray-500 mt-6">
                Versiyon: 1.0.1 (Yapay Zeka destekli)
            </p>
        </div>
    </div>

    <script>
        // HTML element references
        const questionInput = document.getElementById('questionInput');
        const askButton = document.getElementById('askButton');
        const aboutButton = document.getElementById('aboutButton'); // Hakkında butonu
        const aboutModal = document.getElementById('aboutModal');     // Modal penceresi
        const answerBox = document.getElementById('answerBox');
        
        // Modal açma ve kapatma fonksiyonları
        function openModal() {
            aboutModal.classList.add('open');
        }

        function closeModal() {
            aboutModal.classList.remove('open');
        }

        // Buton dinleyicisi ekleme
        aboutButton.addEventListener('click', openModal);

        // Overlay'e tıklanınca kapatma
        aboutModal.addEventListener('click', (e) => {
            if (e.target === aboutModal) {
                closeModal();
            }
        });
        
        // Bu kod, sayfa yüklendiğinde arayüzü temizler. (Arama motoru mantığı)
        document.addEventListener('DOMContentLoaded', () => {
            questionInput.value = '';
            answerBox.textContent = "Buraya yazdığın soruların cevapları, Usta tarafından detaylıca hazırlanıp sana sunulacak.";
        });


        // LLM API Call Wrapper (Exponential Backoff with Retries)
        async function fetchGeminiContent(prompt, apiKey) {
            const maxRetries = 5;
            let currentRetry = 0;
            const model = "gemini-2.5-flash-preview-05-20"; // For Turkish/general Q&A

            const makeApiCall = async () => {
                const chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                const payload = { contents: chatHistory };
                
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`API hatası: ${response.status} ${response.statusText}`);
                }
                return await response.json();
            };

            while (currentRetry < maxRetries) {
                try {
                    return await makeApiCall();
                } catch (error) {
                    currentRetry++;
                    if (currentRetry < maxRetries) {
                        const delay = Math.pow(2, currentRetry) * 1000;
                        await new Promise(resolve => setTimeout(resolve, delay));
                    } else {
                        throw error; // Throw final error after all retries fail
                    }
                }
            }
        }


        // "Ustaya Sor" button event listener
        askButton.addEventListener('click', async () => {
            const userQuestion = questionInput.value.trim();
            if (!userQuestion) {
                answerBox.textContent = "Boş soru kutusuyla ne yapayım? Haydi bir soru yaz da çalışalım!";
                return;
            }

            // UI Güncelleme ve Butonları Devre Dışı Bırakma
            answerBox.innerHTML = `
                <div id="loading-message" class="loading-container active">
                    <div class="spinner"></div>
                    <p class="mt-2 text-sm text-gray-400">Cevap hazırlanıyor, Usta iş başında...</p>
                </div>
            `;
            askButton.disabled = true;
            aboutButton.disabled = true; // Yükleme sırasında Hakkında butonunu da devre dışı bırak

            // Prompt hazırlığı
            const prompt = `Merhaba, ben bu uygulamanın ustasıyım. Bir kullanıcı olarak bana "${userQuestion}" diye sordun. Sana en iyi şekilde, anlaşılır ve basit adımlarla yardımcı olacağım. Cevabımı sadece Türkçe olarak ver ve sanki doğrudan seninle konuşuyormuşum gibi samimi bir dil kullan.`;
            const apiKey = ""; // API key boş bırakıldı, ortam tarafından sağlanacak

            try {
                const apiResponse = await fetchGeminiContent(prompt, apiKey);
                
                const text = apiResponse.candidates[0].content.parts[0].text;
                
                // Cevabı görüntüle
                answerBox.textContent = text;

            } catch (error) {
                console.error("İşlem sırasında büyük bir hata oluştu:", error);
                answerBox.textContent = "Üzgünüm, API çağrısı başarısız oldu veya cevap işlenemedi. Lütfen daha sonra tekrar deneyin.";
            } finally {
                // Yüklenme ekranını kaldır ve butonları tekrar etkinleştir
                const loadingMessage = document.getElementById('loading-message');
                if (loadingMessage) {
                    loadingMessage.classList.remove('active');
                }
                askButton.disabled = false;
                aboutButton.disabled = false; // Hakkında butonunu tekrar etkinleştir
            }
        });
    </script>
</body>
</html>
